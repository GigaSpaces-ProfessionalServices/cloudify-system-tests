tosca_definitions_version: cloudify_dsl_1_0

imports:
    - http://www.getcloudify.org/spec/cloudify/3.1rc2/types.yaml
    - http://www.getcloudify.org/spec/openstack-plugin/1.1rc2/plugin.yaml

inputs:
    keystone_username: {}
    keystone_password: {}
    keystone_tenant_name: {}
    keystone_url: {}
    region: {}
    other_region_nova_url: {}
    other_region_neutron_url: {}

node_templates:
    network:
        type: cloudify.openstack.nodes.Network
        properties:
            resource_id: network
    keypair:
        type: cloudify.openstack.nodes.KeyPair
        properties:
            resource_id: keypair
            private_key_path: ~/.ssh/keypair1.pem
    network_other_region:
        type: cloudify.openstack.nodes.Network
        properties:
            resource_id: network
            openstack_config:
                # using a full configuration
                username: { get_input: keystone_username }
                password: { get_input: keystone_password }
                tenant_name: { get_input: keystone_tenant_name }
                auth_url: { get_input: keystone_url }
                region: { get_input: region }
                nova_url: { get_input: other_region_nova_url }
                neutron_url: { get_input: other_region_neutron_url }
    keypair_other_region:
        type: cloudify.openstack.nodes.KeyPair
        properties:
            resource_id: keypair
            private_key_path: ~/.ssh/keypair2.pem
            openstack_config:
                # using minimal configuration - the rest of the definitions should be taken from the manager openstack creds file
                nova_url: { get_input: other_region_nova_url }