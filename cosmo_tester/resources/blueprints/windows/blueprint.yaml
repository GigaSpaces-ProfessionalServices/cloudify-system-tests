tosca_definitions_version: cloudify_dsl_1_0

imports:
    - http://www.getcloudify.org/spec/cloudify/3.1/types.yaml
    - http://www.getcloudify.org/spec/openstack-plugin/1.1/plugin.yaml
    - http://www.getcloudify.org/spec/script-plugin/1.1/plugin.yaml

node_templates:
    vm:
        type: cloudify.openstack.windows_server
        properties:
            server:
                name: windows-agent-vm
                image_name: windows-agent-machine
                flavor: 102
            cloudify_agent:
                service:
                    successful_consecutive_status_queries_count: 10
                    status_transition_sleep_interval: 5
                    start_timeout: 240
                    stop_timeout: 240
                user: Administrator
                password: 1408Rokk

    app:
        type: cloudify.types.app_module
        interfaces:
            cloudify.interfaces.lifecycle:
                -   start:
                        mapping: script.script_runner.tasks.run
                        properties:
                            script_path: scripts/hello.py
        relationships:
            -   type: cloudify.relationships.contained_in
                target: vm
