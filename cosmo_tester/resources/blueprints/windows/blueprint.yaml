imports:
    - http://www.getcloudify.org/spec/cloudify/3.1/types.yaml
    - http://www.getcloudify.org/spec/openstack-plugin/1.1/plugin.yaml

plugins:
    python_script_executor:
        derived_from: cloudify.plugins.agent_plugin
        properties:
            url: https://github.com/cloudify-cosmo/cloudify-python-plugin/archive/master.zip

node_types:
    cloudify.types.python.app_module:
        derived_from: cloudify.types.app_module
        interfaces:
            cloudify.interfaces.lifecycle:
                - start: python_script_executor.tasks.run
        properties:
            scripts: {}

node_templates:
    vm:
        type: cloudify.openstack.windows_server
        properties:
            server:
                name: windows-agent-vm
                image_name: windows-agent-machine
                flavor: 102
            cloudify_agent:
                service:
                    successful_consecutive_status_queries_count: 2
                    start_timeout: 60
                user: Administrator
                password : 1408Rokk

    app:
        type: cloudify.types.python.app_module
        properties:
            scripts:
                start: scripts/hello.py
        relationships:
            -   type: cloudify.relationships.contained_in
                target: vm