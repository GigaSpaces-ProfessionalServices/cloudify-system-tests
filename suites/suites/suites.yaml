variables:
  hp_openstack_ubuntu_precise_image_name: Ubuntu Server 12.04.5 LTS (amd64 20140927) - Partner Image
  hp_openstack_ubuntu_trusty_image_name: Ubuntu Server 14.04.1 LTS (amd64 20140927) - Partner Image
  hp_openstack_centos_image_name: CentOS 6.3 Server 64-bit 20130116
  hp_openstack_region_a_ubuntu_precise: 8ca068c5-6fde-4701-bab8-322b3e7c8d81
  hp_openstack_region_a_ubuntu_trusty: bec3cab5-4722-40b9-a78a-3489218e22fe
  hp_openstack_region_b_ubuntu_precise: 261844b3-479c-5446-a2c4-1ea95d53b668
  hp_openstack_region_b_ubuntu_trusty: 9d25fe2d-cf31-4b05-8c58-f238ec78e633
  hp_openstack_region_b_centos_7_0_docker_1_2: 25bfd0c1-8f20-4e8f-a5cf-36ca825305f2

templates:

  - &openstack_plugin_external
    repo: cloudify-openstack-plugin
    branch: CFY-1850-suites-breakup

  - &softlayer_plugin_external
    repo: cloudify-softlayer-plugin

  - &vsphere_plugin_external
    repo: cloudify-vpshere-plugin
    branch: CFY-1850-suites-breakup
    private: true
    username: opencm
    password: '{{OPENCM_GIT_PWD}}'

  #######################################################

  - &hp_openstack_properties
    ubuntu_image_name: '{{hp_openstack_ubuntu_precise_image_name}}'
    ubuntu_trusty_image_name: '{{hp_openstack_ubuntu_trusty_image_name}}'
    centos_image_name: '{{hp_openstack_centos_image_name}}'
    centos_image_user: root
    flavor_name: standard.small
    small_flavor_id: 101

  - &hp_openstack_region_a_properties
    <<: *hp_openstack_properties
    ubuntu_image_id: '{{hp_openstack_region_a_ubuntu_precise}}'
    ubuntu_trusty_image_id: '{{hp_openstack_region_a_ubuntu_trusty}}'

  - &hp_openstack_region_b_properties
    <<: *hp_openstack_properties
    ubuntu_image_id: '{{hp_openstack_region_b_ubuntu_precise}}'
    ubuntu_trusty_image_id: '{{hp_openstack_region_b_ubuntu_trusty}}'

  #######################################################

  - &hp_openstack_credentials_inputs
    keystone_username: '{{HP_KEYSTONE_USERNAME}}'
    keystone_password: '{{HP_KEYSTONE_PASSWORD}}'

  #######################################################

  - &hp_openstack_region_a_inputs
    region: region-a.geo-1
    image_id: '{{hp_openstack_region_a_ubuntu_trusty}}'

  - &hp_openstack_region_b_inputs
    region: region-b.geo-1
    image_id: '{{hp_openstack_region_a_ubuntu_precise}}'

  - &hp_openstack_dockerless_region_a_inputs
    region: region-a.geo-1
    image_id: '{{hp_openstack_region_b_ubuntu_trusty}}'

  - &hp_openstack_dockerless_region_b_inputs
    region: region-b.geo-1
    image_id: '{{hp_openstack_region_b_ubuntu_precise}}'

  #######################################################

  - &openstack_handler_configuration
    handler: openstack_handler
    external: *openstack_plugin_external

  - &hp_openstack_handler_configuration
    <<: *openstack_handler_configuration
    inputs: inputs-hp-openstack.yaml
    manager_blueprint: openstack-docker/openstack-docker.yaml

  - &hp_openstack_dockerless_handler_configuration
    <<: *openstack_handler_configuration
    inputs: inputs-hp-openstack.yaml
    manager_blueprint: openstack/openstack.yaml
    bootstrap_using_docker: false

#####################################################################################

handler_configurations:

  hp_openstack_system_tests_region_a:
    <<: *hp_openstack_handler_configuration
    properties: *hp_openstack_region_a_properties
    inputs_override:
      <<: *hp_openstack_credentials_inputs
      <<: *hp_openstack_region_a_inputs
      keystone_tenant_name: cloudify-cosmo-system-tests

  hp_openstack_system_tests_region_b:
    <<: *hp_openstack_handler_configuration
    properties: *hp_openstack_region_b_properties
    inputs_override:
      <<: *hp_openstack_credentials_inputs
      <<: *hp_openstack_region_b_inputs
      keystone_tenant_name: cloudify-cosmo-system-tests

  hp_openstack_system_tests2_region_a:
    <<: *hp_openstack_handler_configuration
    properties: *hp_openstack_region_a_properties
    inputs_override:
      <<: *hp_openstack_credentials_inputs
      <<: *hp_openstack_region_a_inputs
      keystone_tenant_name: cloudify-cosmo-system-tests2

  hp_openstack_system_tests2_region_b:
    <<: *hp_openstack_handler_configuration
    properties: *hp_openstack_region_b_properties
    inputs_override:
      <<: *hp_openstack_credentials_inputs
      <<: *hp_openstack_region_b_inputs
      keystone_tenant_name: cloudify-cosmo-system-tests2

  ############################################################################

  hp_openstack_dockerless_system_tests_region_a:
    <<: *hp_openstack_dockerless_handler_configuration
    properties: *hp_openstack_region_a_properties
    inputs_override:
      <<: *hp_openstack_credentials_inputs
      <<: *hp_openstack_dockerless_region_a_inputs
      keystone_tenant_name: cloudify-cosmo-system-tests

  hp_openstack_dockerless_system_tests_region_b:
    <<: *hp_openstack_dockerless_handler_configuration
    properties: *hp_openstack_region_b_properties
    inputs_override:
      <<: *hp_openstack_credentials_inputs
      <<: *hp_openstack_dockerless_region_b_inputs
      keystone_tenant_name: cloudify-cosmo-system-tests

  hp_openstack_dockerless_system_tests2_region_a:
    <<: *hp_openstack_dockerless_handler_configuration
    properties: *hp_openstack_region_a_properties
    inputs_override:
      <<: *hp_openstack_credentials_inputs
      <<: *hp_openstack_dockerless_region_a_inputs
      keystone_tenant_name: cloudify-cosmo-system-tests2

  hp_openstack_dockerless_system_tests2_region_b:
    <<: *hp_openstack_dockerless_handler_configuration
    properties: *hp_openstack_region_b_properties
    inputs_override:
      <<: *hp_openstack_credentials_inputs
      <<: *hp_openstack_dockerless_region_b_inputs
      keystone_tenant_name: cloudify-cosmo-system-tests2

  #############################################################################

  hp_openstack_centos_system_tests_region_b:
    <<: *hp_openstack_handler_configuration
    properties: *hp_openstack_region_b_properties
    inputs_override:
      <<: *hp_openstack_credentials_inputs
      <<: *hp_openstack_region_b_inputs
      keystone_tenant_name: cloudify-cosmo-system-tests
      image_id: '{{hp_openstack_region_b_centos_7_0_docker_1_2}}'
      manager_server_user: centos

  ############################################################################

  pclab47_devstack_nova_net:
    <<: *openstack_handler_configuration
    handler: openstack_nova_net_handler
    inputs: inputs-nova-net-devstack.yaml
    manager_blueprint: openstack-nova-net/openstack.yaml
    bootstrap_using_docker: false
    properties:
      ubuntu_image_name: ubuntu
      flavor_name: m1.small
      ubuntu_image_id: eada2fe8-894a-4b26-ac8d-cedab010f185
      small_flavor_id: 3

  ###############################################################################

  aws_ec2:
    inputs: cloudify-config-ec2.yaml
    handler: ec2
    bootstrap_using_providers: true
    bootstrap_using_docker: false
    properties:
      medium_instance_type: m1.medium
      ubuntu_agent_ami: ami-a73264ce
    inputs_override:
      connection.access_id: '{{AWS_ACCESS_ID}}'
      connection.secret_key: '{{AWS_SECRET_KEY}}'

  ################################################################################

  vsphere:
    inputs: inputs-vsphere.yaml
    handler: vpshere_handler
    external: *vsphere_plugin_external
    manager_blueprint: manager_blueprint/vsphere.yaml
    bootstrap_using_docker: false
    properties:
      template: ubuntu-configured-template
    inputs_override:
      vsphere_username: '{{VSPHERE_USERNAME}}'
      vsphere_password: '{{VSPHERE_PASSWORD}}'
      vsphere_url: '{{VSPHERE_URL}}'
      vsphere_datacenter_name: '{{VCENTER_NAME}}'

  ################################################################################

  softlayer:
    inputs: inputs-softlayer.yaml
    handler: softlayer_handler
    external: *softlayer_plugin_external
    manager_blueprint: softlayer/softlayer.yaml
    bootstrap_using_docker: false
    inputs_override:
      username: '{{SOFTLAYER_USERNAME}}'
      api_key: '{{SOFTLAYER_API_KEY}}'

#####################################################################################

tests:

  openstack_blueprints:
    tests:
      - cosmo_tester/test_suites/test_blueprints

  openstack_blueprints_without_chef_puppet:
    - cosmo_tester/test_suites/test_blueprints -e puppet -e chef

  openstack_chef_puppet_blueprints:
    tests:
      - cosmo_tester/test_suites/test_blueprints/chef_plugin_test.py
      - cosmo_tester/test_suites/test_blueprints/puppet_plugin_test.py

  manager_status:
    tests:
      - cosmo_tester/test_suites/test_manager_status

  openstack_plugin:
    tests:
      - cosmo_tester/test_suites/test_openstack_plugin

  docker_centos:
    tests:
      - cosmo_tester/test_suites/test_docker_centos_env

  ec2_blueprints:
    tests:
      - cosmo_tester/test_suites/ec2_test_blueprints

  vsphere_blueprints:
    tests:
      - cosmo_tester/test_suites/vsphere_test_blueprints

  softlayer_blueprints:
    external: *softlayer_plugin_external
    tests:
      - softlayer_plugin/system_tests/manager
      - softlayer_plugin/system_tests/local

#####################################################################################

test_suites:

  hp_openstack_blueprints_no_chef_puppet:
    handler_configuration: hp_openstack_system_tests_region_a
    tests:
      - openstack_blueprints_without_chef_puppet

  hp_openstack_chef_puppet:
    handler_configuration: hp_openstack_system_tests_region_b
    tests:
      - openstack_blueprints

  hp_openstack_manager_status:
    handler_configuration: hp_openstack_system_tests2_region_a
    tests:
      - manager_status

  hp_openstack_plugin_tests:
    handler_configuration: hp_openstack_system_tests2_region_b
    tests:
      - openstack_plugin

  #####################################################################

  dockerless_hp_openstack_blueprints_no_chef_puppet:
    handler_configuration: hp_openstack_dockerless_system_tests_region_a
    tests:
      - openstack_blueprints_without_chef_puppet

  dockerless_hp_openstack_chef_puppet:
    handler_configuration: hp_openstack_dockerless_system_tests_region_b
    tests:
      - openstack_blueprints

  dockerless_hp_openstack_manager_status:
    handler_configuration: hp_openstack_dockerless_system_tests2_region_a
    tests:
      - manager_status

  dockerless_hp_openstack_plugin_tests:
    handler_configuration: hp_openstack_dockerless_system_tests2_region_b
    tests:
      - openstack_plugin

  #####################################################################

  pclab47_devstack_nova_net:
    handler_configuration: pclab47_devstack_nova_net
    tests:
      - cosmo_tester/test_suites/test_openstack_nova_net

  #####################################################################

  docker_centos_on_openstack:
    handler_configuration: hp_openstack_centos_system_tests_region_b
    tests:
      - cosmo_tester/test_suites/test_docker_centos_env

  ######################################################################

  aws_ec2:
    handler_configuration: aws_ec2
    tests:
      - ec2_blueprints

  ########################################################################

  vsphere:
    handler_configuration: vsphere
    tests:
      - vsphere_blueprints

  ########################################################################

  softlayer:
    handler_configuration: softlayer
    tests:
      - softlayer_blueprints
